# LOGiC Off Grid Location Analyser
This application was designed to take simple inputs and provide users with information when considering off-grid energy systems

## Getting Started

These instructions will get you a copy of the project up and running on your local machine for development and testing purposes. See deployment for notes on how to deploy the project on a live system.

### Prerequisites
* A python virtual environment manager, such as [Anaconda](https://www.anaconda.com/distribution/).

* [CBC-Solver](https://ampl.com/dl/open/cbc/) must be installed and added to the PATH environment variable in order for the application to make calculations. [How to set environment variables](http://www.computerhope.com/issues/ch000549.htm).

* A LaTeX compiler such as [MiKTeX](https://miktex.org/download) must be installed to allow for report functionality and must also be added to the PATH environment variable, the same way the CBC-Solver is added.

### Installing
1. Create a new python environment using Python version 3.6. We will use Anaconda as an example.
```
conda create -n yourenvname python=3.6
source activate yourenvname
```

2. Move to the directory you would like to install to.
```
cd path/to/install/directory
```

3. Clone the master branch of the repository.
```
git clone https://github.com/binduvr/LOGiC.git
```

4. Move into the cloned directory
```
cd LOGiC
```

5. Install the requirements for the application
```
pip install -r requirements.txt
```

## Running the application
To run the application:
1. Change the values in admin_settings.ini to suit your needs.

2. Run run.py to start the web server
```
python run.py
```

3. The server is now running.

### Routes
The application has various routes (or URLs) which have different functions. All URLs for the development version have the prefix *http://localhost:5000/* which is to be placed before the following routes. These routes return output in JSON format.

* Get location based factors
```
location_data/offgridders_data/<country_code>
```
This URL will retrieve factors which can based on location such as fuel price which can be used the the Offgridders tool.
This request will out put JSON in the foloowing form:
```
{ 
  'country_code': 'NL',
  'blackout_frequency': None,
  'blackout_duration': None,
  'electricity_price': 0.22,
  'renewable_share': 0.05889463078827299,
  'tax': 0.21,
  'diesel_price': 1.221678
}
```


* Run simulation
```
offgrid_simulator/simulate
```
This URL will start a simulation and return a session ID which is used to retrieve information in the other routes. This route must be requested using a POST request using JSON in the following form where *additional_parameters* becomes the output of the previous request.:
```
{
  'project_name': 'hoevelaken',
  'country_code': 'NL',
  'address': "some random address",
  'latitude': 51,
  'longitude': 5,
  'demands': {
      'residential_demand': 35000,
      'commercial_demand': 0,
      'industrial_demand': 0
  },
  'active_components': {
      'wind': True,
      'solar': True,
      'storage': True,
      'dieselgen': True,
      'grid_connection': False
  },
  'additional_parameters': {}
}
```


* Get static results
```
offgrid_simulator/get_result/<session_id>
```
This URL will retrieve the single output values from the simulation where *<session_id>* is the result of the simulation route such as *20191029133752*. The simulation takes some time, therefore it may take a while before this route successfully retrieves the results.


* Get typical day time series
```
offgrid_simulator/daily_time_series/<session_id>/<type_of_day>
```
This URL will retrieve an hourly time series of the various outputs at the specified type of day. These days can have the following possible values: *mid_summer, mid_winter, spring_equinox* and *autumn_equinox*.


* Get monthly totals time series
```
offgrid_simulator/monthly_time_series/<session_id>
```
This URL will retrieve a monthly time series containing the monthly totals of each output.


* Get demand time series
```
offgrid_simulator/demand_series/<session_id>
```
This URL will retrieve energy consumption profiles which were generated by the users input using location + annual power demand.


* Email report
```
report/email
```
This URL requires an email and a session ID to be included in the POST request and will send the report generated for the session ID's simulation to the specified email address.


* Download report
```
report/download/<session_id>
```
This URL will retrieve the report in the web browser which was generated for the simulation of the session ID.


## Testing
To test the application:
1. Edit test/tests.py to specify which routes you would like to test. Also change the email to your own email address.

2. Run run.py to start the application
```
python run.py
```

3. Run test/tests.py
```
python test/tests.py
```

4. Check the output to ensure success.


## Authors

* **Martha Hoffmann** - *Developer of Offgridders* ([Offgridders](https://github.com/smartie2076/offgridders)) - Reiner Lemoine Institute, Berlin
* **Marien Boonman** - Off Grid Test Center, Spanbroek
* **Bindu van Raak** - Off Grid Test Center, Spanbroek


## Acknowledgments

A special thanks to Martha Hoffmann from the Reiner Lemoine Institute in Berlin for the development of Offgridders, the main core of this application.

